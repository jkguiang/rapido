<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.11"/>
<title>RAPIDO: RAPIDO</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">RAPIDO
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.11 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li class="current"><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
</div><!-- top -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">RAPIDO </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p><em>Repeatable Analysis Programming for Interpretability, Durability, and Organization</em></p>
<p><a href="https://opensource.org/licenses/MIT"></a> <a href="https://jkguiang.github.io/rapido/html/index.html"></a> <a href="https://www.codefactor.io/repository/github/jkguiang/rapido/overview/master"></a></p>
<p>RAPIDO is a C++ framework designed to make writing HEP analyses more ergonomic and readable. It wraps some basic functionality of <a href="https://root.cern/">ROOT</a>. The idea is that an analysis, in general, consists of a few objects: a TTree (to hold some skimmed N-Tuple and/or a set of histograms), a cutflow (a collection of boolean logic for filtering events), and a looper (some way to run over multiple files). RAPIDO is designed to handle all three of these tasks such that every analysis that uses it is structured in the same way. In addition, the <em>way</em> in which it is structured lends itself to the common workflow of a HEPEx-er.</p>
<h2>RAPIDO Tools</h2>
<ol type="1">
<li><a class="el" href="classArbol.html">Arbol</a>: TTree wrapper that reduces the hassle of setting up and using TTrees</li>
<li><a class="el" href="classCutflow.html">Cutflow</a>: Binary search tree with lambda nodes and other bells and whistles<ul>
<li><a class="el" href="classHistflow.html">Histflow</a>: An extension of the <a class="el" href="classCutflow.html">Cutflow</a> object that handles histogramming at any given step of the cutflow</li>
</ul>
</li>
<li><a class="el" href="classLooper.html">Looper</a>: Basic looper for a TChain of TFiles that uses any selector</li>
</ol>
<h2>Set Up Instructions</h2>
<ol type="1">
<li>Clone this repository</li>
<li><code>cd</code> into the cloned repository and run <code>make -j5</code></li>
<li>Write your script (e.g. <code>main.cc</code>) and <code>#include</code> whatever you need</li>
<li>Compile and run using your favorite <code>Makefile</code>: <div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;$ g++ main.cc -o ./main -lRAPIDO -Lrapido -Irapido</div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;$ export LD_LIBRARY_PATH=$LD_LIBRARY_PATH:$PWD/rapido</div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;$ ./main</div></div><!-- fragment --></li>
</ol>
<h2>Examples</h2>
<ol type="1">
<li>Minimal <a class="el" href="classCutflow.html">Cutflow</a> example <div class="fragment"><div class="line"><span class="preprocessor">#include &quot;cutflow.h&quot;</span></div><div class="line"><span class="preprocessor">#include &lt;stdlib.h&gt;</span></div><div class="line"></div><div class="line"><span class="keyword">using</span> namepsace std;</div><div class="line"></div><div class="line"><span class="keywordtype">int</span> main()</div><div class="line">{</div><div class="line">    <a class="code" href="classCutflow.html">Cutflow</a> dummy_cutflow = <a class="code" href="classCutflow.html">Cutflow</a>();</div><div class="line"></div><div class="line">    <a class="code" href="classCut.html">Cut</a>* dummy_root = <span class="keyword">new</span> <a class="code" href="classCut.html">Cut</a>(<span class="stringliteral">&quot;root&quot;</span>, []() { <span class="keywordflow">return</span> bool(rand() % 2); });</div><div class="line">    dummy_cutflow.<a class="code" href="classCutflow.html#ad27d37141c3748779a5d81fad919ecbb">setRoot</a>(dummy_root);</div><div class="line"></div><div class="line">    <a class="code" href="classCut.html">Cut</a>* node0 = <span class="keyword">new</span> <a class="code" href="classCut.html">Cut</a>(<span class="stringliteral">&quot;node0&quot;</span>, []() { <span class="keywordflow">return</span> bool(rand() % 2); });</div><div class="line">    dummy_cutflow.<a class="code" href="classCutflow.html#a8da46f1053a6b97991489ee0920c29a1">insert</a>(<span class="stringliteral">&quot;root&quot;</span>, node0, Left);</div><div class="line"></div><div class="line">    <a class="code" href="classCut.html">Cut</a>* node1 = <span class="keyword">new</span> <a class="code" href="classCut.html">Cut</a>(<span class="stringliteral">&quot;node1&quot;</span>, []() { <span class="keywordflow">return</span> bool(rand() % 2); });</div><div class="line">    dummy_cutflow.<a class="code" href="classCutflow.html#a8da46f1053a6b97991489ee0920c29a1">insert</a>(<span class="stringliteral">&quot;root&quot;</span>, node1, Right);</div><div class="line"></div><div class="line">    <a class="code" href="classCut.html">Cut</a>* node2 = <span class="keyword">new</span> <a class="code" href="classCut.html">Cut</a>(<span class="stringliteral">&quot;node2&quot;</span>, []() { <span class="keywordflow">return</span> bool(rand() % 2); });</div><div class="line">    dummy_cutflow.<a class="code" href="classCutflow.html#a8da46f1053a6b97991489ee0920c29a1">insert</a>(<span class="stringliteral">&quot;node1&quot;</span>, node2, Right);</div><div class="line"></div><div class="line">    <a class="code" href="classCut.html">Cut</a>* node3 = <span class="keyword">new</span> <a class="code" href="classCut.html">Cut</a>(<span class="stringliteral">&quot;node3&quot;</span>, []() { <span class="keywordflow">return</span> bool(rand() % 2); });</div><div class="line">    dummy_cutflow.<a class="code" href="classCutflow.html#a8da46f1053a6b97991489ee0920c29a1">insert</a>(<span class="stringliteral">&quot;node1&quot;</span>, node3, Left);</div><div class="line"></div><div class="line">    <a class="code" href="classCut.html">Cut</a>* node4 = <span class="keyword">new</span> <a class="code" href="classCut.html">Cut</a>(<span class="stringliteral">&quot;node4&quot;</span>, []() { <span class="keywordflow">return</span> bool(rand() % 2); });</div><div class="line">    dummy_cutflow.<a class="code" href="classCutflow.html#a8da46f1053a6b97991489ee0920c29a1">insert</a>(<span class="stringliteral">&quot;node2&quot;</span>, node4, Right);</div><div class="line"></div><div class="line">    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; 5; i++)</div><div class="line">    {</div><div class="line">        <a class="code" href="classCut.html">Cut</a>* terminal_node = dummy_cutflow.<a class="code" href="classCutflow.html#a563da4fc41aa5c611dd0ce37ce966f2c">run</a>();</div><div class="line">        cout &lt;&lt; <span class="stringliteral">&quot;terminated at &quot;</span> &lt;&lt; terminal_node-&gt;<a class="code" href="classCut.html#accf700d2d00746b97a265d4aea3f55c2">name</a> &lt;&lt; endl;</div><div class="line">    }</div><div class="line">    dummy_cutflow.<a class="code" href="classCutflow.html#a0cb4c8bd6d15ace1f85fe0cfb8d9d828">print</a>();</div><div class="line"></div><div class="line">    <span class="keywordflow">return</span> 0;</div><div class="line">}</div></div><!-- fragment --></li>
<li>A simple Arbol+Looper example (using <a href="https://github.com/cmstas/NanoTools">NanoCORE</a> to read NanoAOD) <div class="fragment"><div class="line"><span class="comment">// NanoCORE</span></div><div class="line"><span class="preprocessor">#include &quot;Nano.h&quot;</span></div><div class="line"><span class="comment">// RAPIDO</span></div><div class="line"><span class="preprocessor">#include &quot;arbol.h&quot;</span></div><div class="line"><span class="preprocessor">#include &quot;looper.h&quot;</span></div><div class="line"></div><div class="line"><span class="keywordtype">int</span> main()</div><div class="line">{</div><div class="line">    <span class="comment">// Initialize Arbol</span></div><div class="line">    TFile* output_tfile = <span class="keyword">new</span> Tfile(<span class="stringliteral">&quot;output.root&quot;</span>, <span class="stringliteral">&quot;RECREATE&quot;</span>);</div><div class="line">    <a class="code" href="classArbol.html">Arbol</a> arbol = <a class="code" href="classArbol.html">Arbol</a>(output_tfile);</div><div class="line"></div><div class="line">    <span class="comment">// Initialize branches</span></div><div class="line">    arbol.<a class="code" href="classArbol.html#a552622885ffce15f1b1369fe44e729bb">newBranch</a>&lt;<span class="keywordtype">int</span>&gt;(<span class="stringliteral">&quot;event&quot;</span>);</div><div class="line">    arbol.<a class="code" href="classArbol.html#a552622885ffce15f1b1369fe44e729bb">newBranch</a>&lt;<span class="keywordtype">float</span>&gt;(<span class="stringliteral">&quot;met&quot;</span>);</div><div class="line">    arbol.<a class="code" href="classArbol.html#a552622885ffce15f1b1369fe44e729bb">newBranch</a>&lt;<span class="keywordtype">float</span>&gt;(<span class="stringliteral">&quot;ht&quot;</span>);</div><div class="line">    arbol.<a class="code" href="classArbol.html#a552622885ffce15f1b1369fe44e729bb">newBranch</a>&lt;<span class="keywordtype">int</span>&gt;(<span class="stringliteral">&quot;n_jets&quot;</span>);</div><div class="line">    arbol.<a class="code" href="classArbol.html#a57b6cf7cca6cbb3b75bb0e0333dbe3c8">newVecBranch</a>&lt;<span class="keywordtype">float</span>&gt;(<span class="stringliteral">&quot;good_jet_pt&quot;</span>); <span class="comment">// newVecBranch&lt;float&gt; &lt;--&gt; newBranch&lt;std::vector&lt;float&gt;&gt;</span></div><div class="line"></div><div class="line">    <span class="comment">// Get file</span></div><div class="line">    TChain* tchain = <span class="keyword">new</span> TChain(<span class="stringliteral">&quot;Events&quot;</span>); </div><div class="line">    tchain-&gt;Add(<span class="stringliteral">&quot;root://xcache-redirector.t2.ucsd.edu:2040//store/mc/RunIIAutumn18NanoAODv7/TTJets_DiLept_TuneCP5_13TeV-madgraphMLM-pythia8/NANOAODSIM/Nano02Apr2020_102X_upgrade2018_realistic_v21-v1/60000/69CAC742-7679-D342-BF99-BF22B6D10BA4.root&quot;</span>);</div><div class="line"></div><div class="line">    <span class="comment">// Initialize Looper</span></div><div class="line">    <a class="code" href="classLooper.html">Looper</a> looper = <a class="code" href="classLooper.html">Looper&lt;Nano&gt;</a>(tchain, &amp;nt); <span class="comment">// nt is a global variable from NanoCORE</span></div><div class="line"></div><div class="line">    <span class="comment">// Run</span></div><div class="line">    looper.<a class="code" href="classLooper.html#abfa564ca48778da1f58c8a6444ddd463">run</a>(</div><div class="line">        [&amp;]()</div><div class="line">        {</div><div class="line">            <span class="comment">// --&gt; Event-level Logic &lt;--</span></div><div class="line">            <span class="comment">// Reset tree</span></div><div class="line">            arbol.<a class="code" href="classArbol.html#a4c2184d378ab21a9627a57098291a7c4">resetBranches</a>(); <span class="comment">// variables like arbol and nt are captured by reference</span></div><div class="line">            <span class="comment">// Loop over jets</span></div><div class="line">            <span class="keywordtype">float</span> ht = 0.;</div><div class="line">            <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 0; i &lt; nt.nJet(); i++) </div><div class="line">            {</div><div class="line">                <span class="keywordflow">if</span> (nt.Jet_pt()[i] &gt; 30)</div><div class="line">                {</div><div class="line">                    arbol.<a class="code" href="classArbol.html#a811156c9134ca7e0015bbe2ab95434b0">appendToVecLeaf</a>&lt;<span class="keywordtype">float</span>&gt;(<span class="stringliteral">&quot;good_jet_pt&quot;</span>, Jet_pt()[i]);</div><div class="line">                    ht += Jet_pt()[i];</div><div class="line">                }</div><div class="line">            }</div><div class="line">            arbol.<a class="code" href="classArbol.html#a7a8d3bec0bf5c00635a0b00fcd63cf01">setLeaf</a>&lt;<span class="keywordtype">int</span>&gt;(<span class="stringliteral">&quot;event&quot;</span>, event());</div><div class="line">            arbol.<a class="code" href="classArbol.html#a7a8d3bec0bf5c00635a0b00fcd63cf01">setLeaf</a>&lt;<span class="keywordtype">float</span>&gt;(<span class="stringliteral">&quot;ht&quot;</span>, ht);</div><div class="line">            arbol.<a class="code" href="classArbol.html#a7a8d3bec0bf5c00635a0b00fcd63cf01">setLeaf</a>&lt;<span class="keywordtype">float</span>&gt;(<span class="stringliteral">&quot;met&quot;</span>, MET_pt());</div><div class="line">            arbol.<a class="code" href="classArbol.html#a7a8d3bec0bf5c00635a0b00fcd63cf01">setLeaf</a>&lt;<span class="keywordtype">int</span>&gt;(<span class="stringliteral">&quot;n_jets&quot;</span>, arbol.<a class="code" href="classArbol.html#a634be85d92f5f26403407952b10a29fd">getVecLeaf</a>&lt;<span class="keywordtype">float</span>&gt;(<span class="stringliteral">&quot;goot_jet_pt&quot;</span>).size());</div><div class="line">            arbol.<a class="code" href="classArbol.html#a1d029dd97a0451281c774b578d93bcda">fillTTree</a>();</div><div class="line">            <span class="keywordflow">return</span>;</div><div class="line">        }</div><div class="line">    );</div><div class="line">    <span class="comment">// Write results to a ROOT file</span></div><div class="line">    arbol.<a class="code" href="classArbol.html#ade7d835bbe383a70006e86785ae5672c">writeTFile</a>();</div><div class="line">    <span class="keywordflow">return</span> 0;</div><div class="line">}</div></div><!-- fragment --></li>
<li>Arbol+Cutflow+Looper+HEPCLI example (again using <a href="https://github.com/cmstas/NanoTools/tree/master/NanoCORE">NanoCORE</a> to read NanoAOD) <div class="fragment"><div class="line"><span class="comment">// ROOT</span></div><div class="line"><span class="preprocessor">#include &quot;TH1F.h&quot;</span></div><div class="line"><span class="comment">// NanoCORE</span></div><div class="line"><span class="preprocessor">#include &quot;Nano.h&quot;</span></div><div class="line"><span class="preprocessor">#include &quot;tqdm.h&quot;</span> <span class="comment">// progress bar</span></div><div class="line"><span class="preprocessor">#include &quot;SSSelections.h&quot;</span></div><div class="line"><span class="preprocessor">#include &quot;ElectronSelections.h&quot;</span></div><div class="line"><span class="preprocessor">#include &quot;MuonSelections.h&quot;</span></div><div class="line"><span class="comment">// RAPIDO</span></div><div class="line"><span class="preprocessor">#include &quot;arbol.h&quot;</span></div><div class="line"><span class="preprocessor">#include &quot;cutflow.h&quot;</span></div><div class="line"><span class="preprocessor">#include &quot;looper.h&quot;</span></div><div class="line"></div><div class="line"><span class="keyword">using namespace </span>std;</div><div class="line"><span class="keyword">using namespace </span>tas;</div><div class="line"></div><div class="line"><span class="keywordtype">int</span> main(<span class="keywordtype">int</span> argc, <span class="keywordtype">char</span>** argv) </div><div class="line">{</div><div class="line">    <span class="comment">// CLI</span></div><div class="line">    <a class="code" href="classHEPCLI.html">HEPCLI</a> cli = <a class="code" href="classHEPCLI.html">HEPCLI</a>(argc, argv);</div><div class="line"></div><div class="line">    <span class="comment">// Initialize Looper</span></div><div class="line">    <a class="code" href="classLooper.html">Looper</a> looper = <a class="code" href="classLooper.html">Looper&lt;Nano&gt;</a>(&amp;nt, cli.<a class="code" href="classHEPCLI.html#a3d4bb4a7c1f1b6d4e008ff76e43bef15">input_tchain</a>);</div><div class="line"></div><div class="line">    <span class="comment">// Initialize Arbol</span></div><div class="line">    <a class="code" href="classArbol.html">Arbol</a> arbol = <a class="code" href="classArbol.html">Arbol</a>(cli.<a class="code" href="classHEPCLI.html#ab900d2e3822e20d636564874440d33f0">output_tfile</a>);</div><div class="line">    <span class="comment">// Event branches</span></div><div class="line">    arbol.newBranch&lt;<span class="keywordtype">int</span>&gt;(<span class="stringliteral">&quot;event&quot;</span>, -999);</div><div class="line">    arbol.newBranch&lt;<span class="keywordtype">float</span>&gt;(<span class="stringliteral">&quot;met&quot;</span>, -999);</div><div class="line">    <span class="comment">// Leptons</span></div><div class="line">    arbol.newBranch&lt;<span class="keywordtype">int</span>&gt;(<span class="stringliteral">&quot;leading_lep_id&quot;</span>, -999);</div><div class="line">    arbol.newBranch&lt;<span class="keywordtype">float</span>&gt;(<span class="stringliteral">&quot;leading_lep_pt&quot;</span>, -999);</div><div class="line">    arbol.newBranch&lt;<span class="keywordtype">float</span>&gt;(<span class="stringliteral">&quot;leading_lep_eta&quot;</span>, -999);</div><div class="line">    arbol.newBranch&lt;<span class="keywordtype">float</span>&gt;(<span class="stringliteral">&quot;leading_lep_phi&quot;</span>, -999);</div><div class="line">    arbol.newBranch&lt;<span class="keywordtype">int</span>&gt;(<span class="stringliteral">&quot;trailing_lep_id&quot;</span>, -999);</div><div class="line">    arbol.newBranch&lt;<span class="keywordtype">float</span>&gt;(<span class="stringliteral">&quot;trailing_lep_pt&quot;</span>, -999);</div><div class="line">    arbol.newBranch&lt;<span class="keywordtype">float</span>&gt;(<span class="stringliteral">&quot;trailing_lep_eta&quot;</span>, -999);</div><div class="line">    arbol.newBranch&lt;<span class="keywordtype">float</span>&gt;(<span class="stringliteral">&quot;trailing_lep_phi&quot;</span>, -999);</div><div class="line"></div><div class="line">    <span class="comment">// Initialize Cutflow</span></div><div class="line">    <a class="code" href="classCutflow.html">Cutflow</a> cutflow = <a class="code" href="classCutflow.html">Cutflow</a>();</div><div class="line"></div><div class="line">    <span class="comment">// Initialize some hists</span></div><div class="line">    TH1F* ld_lep_pt_hist = <span class="keyword">new</span> TH1F(<span class="stringliteral">&quot;ld_lep_pt_hist&quot;</span>, <span class="stringliteral">&quot;ld_lep_pt_hist&quot;</span>, 20, 0, 200);</div><div class="line">    TH1F* tr_lep_pt_hist = <span class="keyword">new</span> TH1F(<span class="stringliteral">&quot;tr_lep_pt_hist&quot;</span>, <span class="stringliteral">&quot;tr_lep_pt_hist&quot;</span>, 20, 0, 200);</div><div class="line">    cutflow.globals.newVar&lt;TH1F&gt;(<span class="stringliteral">&quot;ld_lep_pt_hist&quot;</span>, *ld_lep_pt_hist);</div><div class="line">    cutflow.globals.newVar&lt;TH1F&gt;(<span class="stringliteral">&quot;tr_lep_pt_hist&quot;</span>, *tr_lep_pt_hist);</div><div class="line"></div><div class="line">    <a class="code" href="classCut.html">Cut</a>* root = <span class="keyword">new</span> <a class="code" href="classCut.html">Cut</a>(</div><div class="line">        <span class="stringliteral">&quot;Bookkeeping&quot;</span>,</div><div class="line">        [&amp;]()</div><div class="line">        {</div><div class="line">            arbol.setLeaf(<span class="stringliteral">&quot;event&quot;</span>, nt.event());</div><div class="line">            arbol.setLeaf(<span class="stringliteral">&quot;met&quot;</span>, nt.MET_pt());</div><div class="line">            <span class="keywordflow">return</span> <span class="keyword">true</span>;</div><div class="line">        },</div><div class="line">        [&amp;]()</div><div class="line">        {</div><div class="line">            <span class="comment">// Dummy weight</span></div><div class="line">            <span class="keywordflow">return</span> 0.001;</div><div class="line">        }</div><div class="line">    );</div><div class="line">    cutflow.setRoot(root);</div><div class="line"></div><div class="line">    <a class="code" href="classCut.html">Cut</a>* dilep_presel = <span class="keyword">new</span> <a class="code" href="classCut.html">Cut</a>(</div><div class="line">        <span class="stringliteral">&quot;DileptonPreselection&quot;</span>,</div><div class="line">        [&amp;]()</div><div class="line">        {</div><div class="line">            <span class="keywordtype">int</span> n_tight_leps = 0;</div><div class="line">            <span class="keywordtype">int</span> n_loose_not_tight_leps = 0;</div><div class="line">            Leptons leptons = getLeptons();</div><div class="line">            Lepton leading_lep;</div><div class="line">            Lepton trailing_lep;</div><div class="line">            <span class="keywordflow">for</span> (<span class="keyword">auto</span>&amp; lep : leptons)</div><div class="line">            {</div><div class="line">                <span class="keywordflow">if</span> (lep.pt() &lt; 20) { <span class="keywordflow">continue</span>; }</div><div class="line">                <span class="keywordflow">if</span> (lep.idlevel() == SS::IDtight) </div><div class="line">                { </div><div class="line">                    <span class="keywordflow">if</span> (lep.pt() &gt; leading_lep.pt()) </div><div class="line">                    { </div><div class="line">                        trailing_lep = leading_lep;</div><div class="line">                        leading_lep = lep; </div><div class="line">                    }</div><div class="line">                    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (lep.pt() &gt; trailing_lep.pt()) { trailing_lep = lep; }</div><div class="line">                    n_tight_leps++; </div><div class="line">                }</div><div class="line">                <span class="keywordflow">if</span> (lep.idlevel() == SS::IDfakable) { n_loose_not_tight_leps++; }</div><div class="line">            }</div><div class="line">            <span class="keywordflow">if</span> (n_tight_leps == 2 &amp;&amp; n_loose_not_tight_leps == 0) </div><div class="line">            {</div><div class="line">                arbol.setLeaf&lt;<span class="keywordtype">int</span>&gt;(<span class="stringliteral">&quot;leading_lep_id&quot;</span>, leading_lep.id());</div><div class="line">                arbol.setLeaf&lt;<span class="keywordtype">float</span>&gt;(<span class="stringliteral">&quot;leading_lep_pt&quot;</span>, leading_lep.pt());</div><div class="line">                arbol.setLeaf&lt;<span class="keywordtype">float</span>&gt;(<span class="stringliteral">&quot;leading_lep_eta&quot;</span>, leading_lep.eta());</div><div class="line">                arbol.setLeaf&lt;<span class="keywordtype">float</span>&gt;(<span class="stringliteral">&quot;leading_lep_phi&quot;</span>, leading_lep.phi());</div><div class="line">                arbol.setLeaf&lt;<span class="keywordtype">int</span>&gt;(<span class="stringliteral">&quot;trailing_lep_id&quot;</span>, trailing_lep.id());</div><div class="line">                arbol.setLeaf&lt;<span class="keywordtype">float</span>&gt;(<span class="stringliteral">&quot;trailing_lep_pt&quot;</span>, trailing_lep.pt());</div><div class="line">                arbol.setLeaf&lt;<span class="keywordtype">float</span>&gt;(<span class="stringliteral">&quot;trailing_lep_eta&quot;</span>, trailing_lep.eta());</div><div class="line">                arbol.setLeaf&lt;<span class="keywordtype">float</span>&gt;(<span class="stringliteral">&quot;trailing_lep_phi&quot;</span>, trailing_lep.phi());</div><div class="line">                <span class="keywordflow">return</span> <span class="keyword">true</span>;</div><div class="line">            }</div><div class="line">            <span class="keywordflow">else</span> { <span class="keywordflow">return</span> <span class="keyword">false</span>; }</div><div class="line">        }</div><div class="line">    );</div><div class="line">    cutflow.insert(<span class="stringliteral">&quot;Bookkeeping&quot;</span>, dilep_presel, Right);</div><div class="line"></div><div class="line">    <a class="code" href="classCut.html">Cut</a>* monolep_or_fakes = <span class="keyword">new</span> <a class="code" href="classCut.html">Cut</a>(<span class="stringliteral">&quot;SingleLepOrFakes&quot;</span>, [&amp;]() { <span class="keywordflow">return</span> <span class="keyword">true</span>; });</div><div class="line">    cutflow.insert(<span class="stringliteral">&quot;DileptonPreselection&quot;</span>, monolep_or_fakes, Left);</div><div class="line"></div><div class="line">    <a class="code" href="classCut.html">Cut</a>* dilep_sign = <span class="keyword">new</span> <a class="code" href="classCut.html">Cut</a>(</div><div class="line">        <span class="stringliteral">&quot;CheckDilepSign&quot;</span>,</div><div class="line">        [&amp;]()</div><div class="line">        {</div><div class="line">            <span class="keywordtype">int</span> leading_lep_id = arbol.getLeaf&lt;<span class="keywordtype">int</span>&gt;(<span class="stringliteral">&quot;leading_lep_id&quot;</span>);</div><div class="line">            <span class="keywordtype">int</span> trailing_lep_id = arbol.getLeaf&lt;<span class="keywordtype">int</span>&gt;(<span class="stringliteral">&quot;trailing_lep_id&quot;</span>);</div><div class="line">            <span class="keywordflow">return</span> leading_lep_id*trailing_lep_id &gt; 0;</div><div class="line">        }</div><div class="line">    );</div><div class="line">    cutflow.insert(<span class="stringliteral">&quot;DileptonPreselection&quot;</span>, dilep_sign, Right);</div><div class="line"></div><div class="line">    <a class="code" href="classCut.html">Cut</a>* SS_presel = <span class="keyword">new</span> <a class="code" href="classCut.html">Cut</a>(<span class="stringliteral">&quot;SSPreselection&quot;</span>, [&amp;]() { <span class="keywordflow">return</span> <span class="keyword">true</span>; });</div><div class="line">    cutflow.insert(<span class="stringliteral">&quot;CheckDilepSign&quot;</span>, SS_presel, Right);</div><div class="line"></div><div class="line">    <a class="code" href="classCut.html">Cut</a>* OS_presel = <span class="keyword">new</span> <a class="code" href="classCut.html">Cut</a>(</div><div class="line">        <span class="stringliteral">&quot;OSPreselection&quot;</span>, </div><div class="line">        [&amp;]() </div><div class="line">        { </div><div class="line">            TH1F&amp; ld_lep_pt_hist = cutflow.globals.getRef&lt;TH1F&gt;(<span class="stringliteral">&quot;ld_lep_pt_hist&quot;</span>);</div><div class="line">            TH1F&amp; tr_lep_pt_hist = cutflow.globals.getRef&lt;TH1F&gt;(<span class="stringliteral">&quot;tr_lep_pt_hist&quot;</span>);</div><div class="line">            ld_lep_pt_hist.Fill(arbol.getLeaf&lt;<span class="keywordtype">float</span>&gt;(<span class="stringliteral">&quot;leading_lep_pt&quot;</span>));</div><div class="line">            tr_lep_pt_hist.Fill(arbol.getLeaf&lt;<span class="keywordtype">float</span>&gt;(<span class="stringliteral">&quot;trailing_lep_pt&quot;</span>));</div><div class="line">            <span class="keywordflow">return</span> <span class="keyword">true</span>; </div><div class="line">        },</div><div class="line">        [&amp;]()</div><div class="line">        {</div><div class="line">            <span class="comment">// Dummy weight</span></div><div class="line">            <span class="keywordflow">return</span> 0.25;</div><div class="line">        }</div><div class="line">    );</div><div class="line">    cutflow.insert(<span class="stringliteral">&quot;CheckDilepSign&quot;</span>, OS_presel, Left);</div><div class="line"></div><div class="line">    <span class="comment">// Run looper</span></div><div class="line">    tqdm bar; <span class="comment">// progress bar</span></div><div class="line">    looper.<a class="code" href="classLooper.html#abfa564ca48778da1f58c8a6444ddd463">run</a>(</div><div class="line">        [&amp;]() </div><div class="line">        {</div><div class="line">            bar.progress(looper.<a class="code" href="classLooper.html#a97e473848469359cd33cd23771e0eb28">n_events_processed</a>, looper.<a class="code" href="classLooper.html#a666747cb782bd6082452a6d5ac18f94f">n_events_to_process</a>);</div><div class="line">            <span class="comment">// Reset tree</span></div><div class="line">            arbol.resetBranches();</div><div class="line">            <span class="comment">// Run cutflow</span></div><div class="line">            <span class="keywordtype">bool</span> passed = cutflow.runUntil(<span class="stringliteral">&quot;OSPreselection&quot;</span>);</div><div class="line">            <span class="keywordflow">if</span> (passed) { arbol.fillTTree(); }</div><div class="line">            <span class="keywordflow">return</span>;</div><div class="line">        }</div><div class="line">    );</div><div class="line"></div><div class="line">    <span class="comment">// Wrap up</span></div><div class="line">    bar.finish();</div><div class="line">    cutflow.print();</div><div class="line">    cutflow.writeCSV();</div><div class="line">    arbol.writeTFile();</div><div class="line">    <span class="keywordflow">return</span> 0;</div><div class="line">}</div></div><!-- fragment --></li>
</ol>
<p>where <code>cutflow.print()</code> yields a visual representation of the cutflow object: </p><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;Cutflow</div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;└☑─Bookkeeping</div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;    13564 (raw)</div><div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;    13.564 (weighted)</div><div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;    └☑─DileptonPreselection</div><div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;        13564 (raw)</div><div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;        13.564 (weighted)</div><div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;        ├☒─SingleLepOrFakes</div><div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;        │   4829 (raw)</div><div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;        │   4.829 (weighted)</div><div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;        └☑─CheckDilepSign</div><div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;            8735 (raw)</div><div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;            8.735 (weighted)</div><div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;            ├☒─OSPreselection</div><div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;            │   8628 (raw)</div><div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;            │   2.157 (weighted)</div><div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;            └☑─SSPreselection</div><div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;                107 (raw)</div><div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;                0.107 (weighted)</div></div><!-- fragment --> </div></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.11
</small></address>
</body>
</html>
