{\itshape Repeatable Analysis Programming for Interpretability, Durability, and Organization}

R\+A\+P\+I\+DO is a C++ framework designed to make writing H\+EP analyses more ergonomic and readable. It wraps some basic functionality of \href{https://root.cern/}{\tt R\+O\+OT}. The idea is that an analysis, in general, consists of a few objects\+: a T\+Tree (to hold some skimmed N-\/\+Tuple and/or a set of histograms), a cutflow (a collection of boolean logic for filtering events), and a looper (some way to run over multiple files). R\+A\+P\+I\+DO is designed to handle all three of these tasks such that every analysis that uses it is structured in the same way. In addition, the {\itshape way} in which it is structured lends itself to the common workflow of a H\+E\+P\+Ex-\/er.

\subsection*{R\+A\+P\+I\+DO Tools}


\begin{DoxyEnumerate}
\item \hyperlink{classArbol}{Arbol}\+: T\+Tree wrapper that reduces the hassle of setting up and using T\+Trees
\item \hyperlink{classCutflow}{Cutflow}\+: Binary search tree with lambda nodes and other bells and whistles
\item \hyperlink{classLooper}{Looper}\+: Basic looper for a T\+Chain of T\+Files that uses any selector
\end{DoxyEnumerate}

\subsection*{Set Up Instructions}


\begin{DoxyEnumerate}
\item Clone this repository
\item {\ttfamily cd} into the cloned repository and run {\ttfamily make -\/j5}
\item Write your script and {\ttfamily \#include} whatever you need
\item Compile and run using your favorite {\ttfamily Makefile}
\end{DoxyEnumerate}

\subsection*{Examples}


\begin{DoxyEnumerate}
\item A simple \hyperlink{classArbol}{Arbol} example (using \href{https://github.com/cmstas/NanoTools}{\tt Nano\+C\+O\+RE} to read Nano\+A\+OD) 
\begin{DoxyCode}
\textcolor{comment}{// NanoCORE}
\textcolor{preprocessor}{#include "Nano.h"}
\textcolor{comment}{// RAPIDO}
\textcolor{preprocessor}{#include "arbol.h"}
\textcolor{preprocessor}{#include "looper.h"}

\textcolor{comment}{// Initialize Arbol}
TFile* output\_tfile = \textcolor{keyword}{new} Tfile(\textcolor{stringliteral}{"output.root"}, \textcolor{stringliteral}{"RECREATE"});
\hyperlink{classArbol}{Arbol} arbol = \hyperlink{classArbol}{Arbol}(output\_tfile);

\textcolor{comment}{// Initialize branches}
arbol.newBranch<\textcolor{keywordtype}{int}>(\textcolor{stringliteral}{"event"});
arbol.newBranch<\textcolor{keywordtype}{float}>(\textcolor{stringliteral}{"met"});
arbol.newBranch<\textcolor{keywordtype}{float}>(\textcolor{stringliteral}{"ht"});
arbol.newBranch<\textcolor{keywordtype}{int}>(\textcolor{stringliteral}{"n\_jets"});
arbol.newVecBranch<\textcolor{keywordtype}{float}>(\textcolor{stringliteral}{"good\_jet\_pt"}); \textcolor{comment}{// newVecBranch<float> <--> newBranch<std::vector<float>>}

\textcolor{comment}{// Get file}
TChain* tchain = \textcolor{keyword}{new} TChain(\textcolor{stringliteral}{"Events"}); 
tchain->Add(\textcolor{stringliteral}{"
      root://xcache-redirector.t2.ucsd.edu:2040//store/mc/RunIIAutumn18NanoAODv7/TTJets\_DiLept\_TuneCP
      5\_13TeV-madgraphMLM-pythia8/NANOAODSIM/Nano02Apr2020\_102X\_upgrade2018\_realistic\_v21-v1/60000/69CAC742-7679-D342-BF99-BF22B6D10BA4.root"});

\textcolor{comment}{// Initialize Looper}
\hyperlink{classLooper}{Looper} looper = \hyperlink{classLooper}{Looper<Nano>}(tchain, &nt); \textcolor{comment}{// nt is a global variable from NanoCORE}

\textcolor{comment}{// Run}
looper.run(
    [&]()
    \{
        \textcolor{comment}{// --> Event-level Logic <--}
        \textcolor{comment}{// Reset tree}
        arbol.resetBranches(); \textcolor{comment}{// variables like arbol and nt are captured by reference}
        \textcolor{comment}{// Loop over jets}
        \textcolor{keywordtype}{float} ht = 0.;
        \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} i = 0; i < nt.nJet(); i++) 
        \{
            \textcolor{keywordflow}{if} (nt.Jet\_pt()[i] > 30)
            \{
                arbol.appendToVecLeaf<\textcolor{keywordtype}{float}>(\textcolor{stringliteral}{"good\_jet\_pt"}, Jet\_pt()[i]);
                ht += Jet\_pt()[i];
            \}
        \}
        arbol.setLeaf<\textcolor{keywordtype}{int}>(\textcolor{stringliteral}{"event"}, event());
        arbol.setLeaf<\textcolor{keywordtype}{float}>(\textcolor{stringliteral}{"ht"}, ht);
        arbol.setLeaf<\textcolor{keywordtype}{float}>(\textcolor{stringliteral}{"met"}, MET\_pt());
        arbol.setLeaf<\textcolor{keywordtype}{int}>(\textcolor{stringliteral}{"n\_jets"}, arbol.getVecLeaf<\textcolor{keywordtype}{float}>(\textcolor{stringliteral}{"goot\_jet\_pt"}).size());
        arbol.fillTTree();
        \textcolor{keywordflow}{return}; \textcolor{comment}{// Must be void}
    \}
);

arbol.writeTFile();
\end{DoxyCode}
 
\end{DoxyEnumerate}